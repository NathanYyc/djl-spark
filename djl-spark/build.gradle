/*
 * This file was generated by the Gradle 'init' task.
 */

plugins {
    id 'java'
    id 'maven-publish'
}

repositories {
    mavenLocal()
    maven {
        url = uri('https://repo.maven.apache.org/maven2/')
    }
}

dependencies {
    implementation 'org.apache.spark:spark-core_2.12:3.0.1'
    implementation 'org.apache.spark:spark-sql_2.12:3.0.1'
    implementation 'commons-cli:commons-cli:1.4'
    implementation 'io.netty:netty-all:4.1.56.Final'
    implementation project(":basicdataset")
    implementation project(":model-zoo")
    implementation project(":examples")
    runtimeOnly 'ai.djl.mxnet:mxnet-native-auto:1.8.0'

    if (System.getProperty("ai.djl.default_engine") == "PyTorch") {
        runtimeOnly project(":pytorch:pytorch-model-zoo")
        runtimeOnly "ai.djl.pytorch:pytorch-native-auto:${pytorch_version}-SNAPSHOT"
    } else if (System.getProperty("ai.djl.default_engine") == "TensorFlow") {
        runtimeOnly project(":tensorflow:tensorflow-model-zoo")
        runtimeOnly "ai.djl.tensorflow:tensorflow-native-auto:${tensorflow_version}-SNAPSHOT"
    } else {
        runtimeOnly project(":mxnet:mxnet-model-zoo")
        runtimeOnly "ai.djl.mxnet:mxnet-native-auto:${mxnet_version}"
    }

    // DLR, tflite, PaddlePaddle and OnnxRuntime are only used for benchmark
    if (System.getProperty("ai.djl.default_engine") == "DLR") {
        runtimeOnly project(":dlr:dlr-engine")
        runtimeOnly "ai.djl.dlr:dlr-native-auto:${dlr_version}"
    } else if (System.getProperty("ai.djl.default_engine") == "TFLite") {
        runtimeOnly project(":tflite:tflite-engine")
        runtimeOnly "ai.djl.tflite:tflite:tflite-native:${tflite_version}"
    } else if (System.getProperty("ai.djl.default_engine") == "PaddlePaddle") {
        runtimeOnly project(":paddlepaddle:paddlepaddle-model-zoo")
        runtimeOnly "ai.djl.paddlepaddle:paddlepaddle-native-auto:${paddlepaddle_version}"
    } else if (System.getProperty("ai.djl.default_engine") == "OnnxRuntime") {
        // onnxruntime requires user install libgomp.so.1 manually, exclude from default dependency
        runtimeOnly project(":onnxruntime:onnxruntime-engine")
    }
}

group = 'ai.djl'
version = '0.11.0-SNAPSHOT'
description = 'djl-spark'
java.sourceCompatibility = JavaVersion.VERSION_1_8

publishing {
    publications {
        maven(MavenPublication) {
            from(components.java)
        }
    }
}
